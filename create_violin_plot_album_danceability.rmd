
Shorter:
```{r}
create_violin_plot_album_danceability <- function(id, authorization = get_spotify_access_token()){
    df_artist <- get_artist_audio_features(id, authorization = authorization)

    ggplot2::ggplot(df_artist, aes(x=album_name, y=danceability))  + 
    ggplot2::geom_violin(aes(fill = album_name))
}
```

<!-- Longer (Unfinished Draft): -->
```{r}
# create_violin_plot_album_danceability <- function(id, authorization = get_spotify_access_token()){
#     info <- get_artists(id, authorization = authorization)
#     artist_id <- info$artist_id
#     artist_name <- info$name
#     if(is.null(artist_id)){
#         stop("No artist found with inputed ID.  Please try again with a different ID.")
#     }
#     albums <- get_artist_projects(artist_id, authorization = authorization)
#     if (is.null(albums) | length(albums)==0) {
#         stop("No albums found with inputed ID.  Please try again with a different ID.")
#     }
#     num_loops <- ceiling(nrow(albums) / 50)
#     if (num_loops > 1) {
#         albums <- purrr::map_df(1:num_loops, function(this_loop) {
#             get_artist_projects(artist_id,
#                               offset = (this_loop - 1) * 50,
#                               authorization = authorization)
#         })
#     }
#     albums <- albums %>%
#         dplyr::rename(
#           album_name = name
#         ) %>%
#         dplyr::mutate(
#           album_release_year = dplyr::case_when(
#               release_date_precision == 'year' ~ suppressWarnings(as.numeric(release_date)),
#               release_date_precision == 'day' ~ lubridate::year(
#                             as.Date(release_date, '%Y-%m-%d',
#                                     origin = '1970-01-01')),
#               TRUE ~ as.numeric(NA))
#         )
#         suppressWarnings({
#         tracks <- purrr::map_df(albums$album_id, function(album_id) {
#             tracks <- get_albums_tracks(album_id,
#                                             authorization = authorization)
#             num_loops <- ceiling(nrow(tracks) / 20)
#                 if (num_loops > 1) {
#                     tracks <- purrr::map_df(1:num_loops, function(this_loop) {
#                         get_albums_tracks(album_id,
#                                         offset = (this_loop - 1) * 20,
#                                         authorization = authorization)
#         })} 
#         tracks <- tracks %>%
#                 dplyr::mutate(
#                 album_id = album_id,
#                 album_name = paste(albums$album_name[albums$album_id == album_id], collapse = ", ")
#                 ) %>%
#                 dplyr::rename(
#                 track_name = name
#                 ) %>%
#                 dplyr::distinct(track_name, .keep_all = TRUE)
#         })
#     })
#     num_loops_tracks <- ceiling(nrow(tracks) / 100)

#     track_audio_features <- purrr::map_df(1:num_loops_tracks, function(this_loop) {
#         track_ids <- tracks %>%
#             dplyr::slice(((this_loop * 100) - 99):(this_loop * 100)) %>%
#             dplyr::pull(track_id)
#         get_track_audio_features(track_ids, authorization = authorization)
#     }) %>%
#         dplyr::left_join(tracks, by = 'track_id') %>%
#         dplyr::select(-album_name)

#     albums %>%
#         dplyr::mutate(
#             artist_name = artist_name,
#             artist_id = artist_id
#     ) %>%
#         dplyr::select(
#             artist_name,
#             artist_id,
#             album_id,
#             album_release_date = release_date,
#             album_release_year,
#             album_release_date_precision = release_date_precision,
#             album_name
#     ) %>%
#         dplyr::left_join(track_audio_features, by = 'album_id') %>%
#         dplyr::mutate(key_name = pitch_class_lookup[key + 1],
#             mode_name = dplyr::case_when(mode == 1 ~ 'major',
#                                     mode == 0 ~ 'minor',
#                                     TRUE ~ as.character(NA)),
#             key_mode = paste(key_name, mode_name)) %>%
#         dplyr::select(-artist_name.y,
#                       -artist_id.y,
#                       -duration_ms.y,
#                       -is_playable) %>%
#         dplyr::rename(artist_name = artist_name.x,
#                       artist_id = artist_id.x,
#                       duration_ms = duration_ms.x)
# }
```